apiVersion: v1
kind: Service
metadata:
  name: web-service-api2
spec:
  type: NodePort
  selector:
    app: api2
  ports:
  - protocol: "TCP"
    port: 5000
    targetPort: 5000

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api2
spec:
  selector:
    matchLabels:
      app: api2
  replicas: 1
  template:
    metadata:
      labels:
        app: api2
    spec:
      volumes:
      - name: my-volume
        persistentVolumeClaim:
          claimName: my-pvc
      containers:
      - name: api2
        image: mraylex/api2:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 5000
        volumeMounts:
        - mountPath: /path/data/
          name: my-volume
---
#apiVersion: networking.k8s.io/v1
#kind: Ingress
#metadata:
#  name: api2-ingress
#  annotations:
#    nginx.ingress.kubernetes.io/rewrite-target: /
#spec:
#    rules:
#      - http:
#          paths:
#          - path: /api2
#            pathType: Prefix
#            backend:
#              service:
#                name: web-service-api2
#                port:
#                  number: 80